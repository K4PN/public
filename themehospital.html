<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cubo de Memoria 3D - Almac√©n Seguro</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Consolas', 'Monaco', monospace;
            background: radial-gradient(circle, #0f0f23, #050510);
            color: #00d4ff;
            overflow: hidden;
            height: 100vh;
            cursor: grab;
        }

        body.dragging {
            cursor: grabbing;
        }

        .container {
            display: flex;
            height: 100vh;
        }

        .cube-container {
            flex: 1;
            position: relative;
            perspective: 1200px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .cube {
            width: 300px;
            height: 300px;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.1s ease;
        }

        .cube-face {
            position: absolute;
            width: 300px;
            height: 300px;
            border: 2px solid #00d4ff;
            background: rgba(0, 212, 255, 0.1);
            backdrop-filter: blur(2px);
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(4, 1fr);
            gap: 2px;
            padding: 8px;
        }

        .cube-face.front { transform: translateZ(150px); }
        .cube-face.back { transform: rotateY(180deg) translateZ(150px); }
        .cube-face.right { transform: rotateY(90deg) translateZ(150px); }
        .cube-face.left { transform: rotateY(-90deg) translateZ(150px); }
        .cube-face.top { transform: rotateX(90deg) translateZ(150px); }
        .cube-face.bottom { transform: rotateX(-90deg) translateZ(150px); }

        .section {
            border: 1px solid #0099cc;
            background: rgba(0, 153, 204, 0.05);
            position: relative;
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            grid-template-rows: repeat(2, 1fr);
            gap: 1px;
            padding: 2px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .section:hover {
            background: rgba(0, 212, 255, 0.2);
            box-shadow: inset 0 0 20px rgba(0, 212, 255, 0.3);
            transform: scale(1.02);
        }

        .section.active {
            background: rgba(255, 215, 0, 0.3);
            border: 2px solid #ffd700;
            box-shadow: 0 0 25px rgba(255, 215, 0, 0.6);
        }

        .cell {
            background: rgba(0, 0, 0, 0.7);
            border: 1px solid #003d4d;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .cell:hover {
            background: rgba(0, 212, 255, 0.4);
            box-shadow: 0 0 15px rgba(0, 212, 255, 0.5);
        }

        .cell.has-data {
            background: rgba(0, 255, 0, 0.3);
            box-shadow: inset 0 0 10px rgba(0, 255, 0, 0.4);
            animation: data-pulse 3s infinite;
        }

        .cell.selected {
            background: rgba(255, 255, 0, 0.6);
            border: 2px solid #ffff00;
            box-shadow: 0 0 20px rgba(255, 255, 0, 0.8);
        }

        @keyframes data-pulse {
            0%, 100% { opacity: 0.7; }
            50% { opacity: 1; }
        }

        .control-panel {
            width: 400px;
            background: rgba(0, 0, 0, 0.95);
            padding: 20px;
            border-left: 2px solid #00d4ff;
            overflow-y: auto;
            backdrop-filter: blur(10px);
        }

        .panel-section {
            margin-bottom: 20px;
            padding: 15px;
            border: 1px solid #00d4ff;
            border-radius: 8px;
            background: rgba(0, 212, 255, 0.05);
            backdrop-filter: blur(5px);
        }

        .panel-section h3 {
            color: #00d4ff;
            margin-bottom: 12px;
            font-size: 16px;
            text-transform: uppercase;
            text-align: center;
            text-shadow: 0 0 10px rgba(0, 212, 255, 0.5);
        }

        .coordinates {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin-bottom: 15px;
        }

        .coord-input, .data-input, .encryption-select {
            padding: 10px;
            background: rgba(0, 0, 0, 0.8);
            border: 1px solid #00d4ff;
            border-radius: 4px;
            color: #00d4ff;
            font-family: inherit;
            font-size: 12px;
        }

        .data-input {
            width: 100%;
            min-height: 80px;
            resize: vertical;
            margin-bottom: 10px;
        }

        .btn {
            background: linear-gradient(45deg, rgba(0, 212, 255, 0.2), rgba(0, 150, 200, 0.3));
            border: 1px solid #00d4ff;
            color: #00d4ff;
            padding: 12px 20px;
            cursor: pointer;
            font-family: inherit;
            font-size: 12px;
            margin: 5px;
            transition: all 0.3s ease;
            border-radius: 6px;
            text-transform: uppercase;
            font-weight: bold;
        }

        .btn:hover {
            background: linear-gradient(45deg, rgba(0, 212, 255, 0.4), rgba(0, 150, 200, 0.5));
            box-shadow: 0 0 20px rgba(0, 212, 255, 0.6);
            transform: translateY(-2px);
        }

        .btn:active {
            transform: translateY(0);
        }

        .data-display {
            background: rgba(0, 0, 0, 0.9);
            border: 1px solid #00d4ff;
            border-radius: 6px;
            padding: 15px;
            min-height: 120px;
            font-size: 12px;
            word-wrap: break-word;
            margin-bottom: 10px;
        }

        .status {
            padding: 10px;
            margin: 8px 0;
            border-radius: 6px;
            font-size: 12px;
            font-weight: bold;
        }

        .status.success {
            background: rgba(0, 255, 100, 0.2);
            border: 1px solid #00ff64;
            color: #00ff64;
        }

        .status.error {
            background: rgba(255, 50, 50, 0.2);
            border: 1px solid #ff3232;
            color: #ff6666;
        }

        .info-display {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.9);
            padding: 15px;
            border: 1px solid #00d4ff;
            border-radius: 8px;
            font-size: 12px;
            backdrop-filter: blur(10px);
        }

        .navigation-info {
            position: absolute;
            bottom: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.9);
            padding: 15px;
            border: 1px solid #00d4ff;
            border-radius: 8px;
            font-size: 11px;
            backdrop-filter: blur(10px);
        }

        .face-labels {
            position: absolute;
            font-size: 14px;
            font-weight: bold;
            color: #ffd700;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.8);
            z-index: 10;
        }

        .controls-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .memory-stats {
            background: rgba(0, 50, 100, 0.3);
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 10px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="cube-container" id="cubeContainer">
            <div class="info-display">
                <div><strong>Posici√≥n:</strong> Cara <span id="currentFace">Frontal</span></div>
                <div><strong>Secci√≥n:</strong> <span id="currentSection">-</span></div>
                <div><strong>Celda:</strong> <span id="currentCell">-</span></div>
                <div><strong>Zoom:</strong> <span id="zoomLevel">100</span>%</div>
            </div>

            <div class="navigation-info">
                <div><strong>Controles:</strong></div>
                <div>üñ±Ô∏è Arrastrar: Rotar cubo</div>
                <div>üé° Rueda: Zoom in/out</div>
                <div>üîç Click: Seleccionar celda</div>
            </div>

            <div class="cube" id="cube">
                <!-- Cara Frontal -->
                <div class="cube-face front" data-face="front">
                    <div class="face-labels" style="top: -25px; left: 50%; transform: translateX(-50%);">FRONTAL</div>
                </div>
                
                <!-- Cara Trasera -->
                <div class="cube-face back" data-face="back">
                    <div class="face-labels" style="top: -25px; left: 50%; transform: translateX(-50%);">TRASERA</div>
                </div>
                
                <!-- Cara Derecha -->
                <div class="cube-face right" data-face="right">
                    <div class="face-labels" style="top: -25px; left: 50%; transform: translateX(-50%);">DERECHA</div>
                </div>
                
                <!-- Cara Izquierda -->
                <div class="cube-face left" data-face="left">
                    <div class="face-labels" style="top: -25px; left: 50%; transform: translateX(-50%);">IZQUIERDA</div>
                </div>
                
                <!-- Cara Superior -->
                <div class="cube-face top" data-face="top">
                    <div class="face-labels" style="top: -25px; left: 50%; transform: translateX(-50%);">SUPERIOR</div>
                </div>
                
                <!-- Cara Inferior -->
                <div class="cube-face bottom" data-face="bottom">
                    <div class="face-labels" style="top: -25px; left: 50%; transform: translateX(-50%);">INFERIOR</div>
                </div>
            </div>
        </div>
        
        <div class="control-panel">
            <div class="panel-section">
                <h3>üìä Estado del Cubo</h3>
                <div class="memory-stats">
                    <div>Celdas Totales: <span id="totalCells">96</span></div>
                    <div>Datos Almacenados: <span id="storedData">0</span></div>
                    <div>Memoria Usada: <span id="memoryUsed">0</span>%</div>
                </div>
            </div>

            <div class="panel-section">
                <h3>üíæ Almacenar Datos</h3>
                <div class="coordinates">
                    <select class="coord-input" id="faceSelect">
                        <option value="front">Frontal</option>
                        <option value="back">Trasera</option>
                        <option value="right">Derecha</option>
                        <option value="left">Izquierda</option>
                        <option value="top">Superior</option>
                        <option value="bottom">Inferior</option>
                    </select>
                    <input type="number" class="coord-input" id="sectionInput" placeholder="Secci√≥n (0-15)" min="0" max="15">
                    <input type="number" class="coord-input" id="cellInput" placeholder="Celda (0-3)" min="0" max="3">
                </div>
                
                <input type="text" class="data-input" id="dataLabel" placeholder="Etiqueta (ej: Gmail, Facebook...)" style="margin-bottom: 10px;">
                
                <textarea class="data-input" id="dataToStore" placeholder="Ingresa la contrase√±a o datos a almacenar..."></textarea>
                
                <select class="encryption-select" id="encryptionMethod">
                    <option value="caesar">üîê Cifrado C√©sar</option>
                    <option value="base64">üìä Base64</option>
                    <option value="reverse">üîÑ Texto Invertido</option>
                    <option value="xor">‚ö° XOR Cipher</option>
                    <option value="rot13">üåÄ ROT13</option>
                </select>
                
                <div class="controls-grid">
                    <button class="btn" onclick="storeData()">üíæ Almacenar</button>
                    <button class="btn" onclick="autoSelect()">üéØ Auto-ubicar</button>
                </div>
            </div>

            <div class="panel-section">
                <h3>üîç Acceder a Datos</h3>
                <button class="btn" onclick="retrieveData()" style="width: 100%;">üìñ Leer Celda Actual</button>
                <div class="data-display" id="dataDisplay">Selecciona una celda con datos...</div>
                <div class="controls-grid">
                    <button class="btn" onclick="decryptData()">üîì Desencriptar</button>
                    <button class="btn" onclick="deleteData()">üóëÔ∏è Eliminar</button>
                </div>
            </div>

            <div class="panel-section">
                <h3>‚öôÔ∏è Herramientas</h3>
                <div class="controls-grid">
                    <button class="btn" onclick="resetView()">üéØ Centrar Vista</button>
                    <button class="btn" onclick="exportData()">üì§ Exportar</button>
                    <button class="btn" onclick="importData()">üì• Importar</button>
                    <button class="btn" onclick="clearAllData()">üßπ Limpiar Todo</button>
                </div>
            </div>

            <div class="panel-section">
                <h3>üì° Estado del Sistema</h3>
                <div id="statusDisplay"></div>
            </div>
        </div>
    </div>

    <script>
        // Estado del sistema
        let cube = document.getElementById('cube');
        let isMouseDown = false;
        let mouseX = 0, mouseY = 0;
        let rotationX = -15, rotationY = 15;
        let scale = 1;
        let currentSelection = null;
        let dataStorage = {};
        let currentEncryptedData = null;

        // M√©todos de encriptaci√≥n mejorados
        const encryptionMethods = {
            caesar: {
                encrypt: (text, shift = 7) => {
                    return text.replace(/[a-zA-Z0-9]/g, function(char) {
                        if (/[0-9]/.test(char)) {
                            return String.fromCharCode(((char.charCodeAt(0) - 48 + shift) % 10) + 48);
                        }
                        const start = char <= 'Z' ? 65 : 97;
                        return String.fromCharCode(((char.charCodeAt(0) - start + shift) % 26) + start);
                    });
                },
                decrypt: (text, shift = 7) => {
                    return text.replace(/[a-zA-Z0-9]/g, function(char) {
                        if (/[0-9]/.test(char)) {
                            return String.fromCharCode(((char.charCodeAt(0) - 48 - shift + 10) % 10) + 48);
                        }
                        const start = char <= 'Z' ? 65 : 97;
                        return String.fromCharCode(((char.charCodeAt(0) - start - shift + 26) % 26) + start);
                    });
                }
            },
            base64: {
                encrypt: (text) => btoa(unescape(encodeURIComponent(text))),
                decrypt: (text) => {
                    try {
                        return decodeURIComponent(escape(atob(text)));
                    } catch (e) {
                        return "‚ùå Error de desencriptaci√≥n Base64";
                    }
                }
            },
            reverse: {
                encrypt: (text) => text.split('').reverse().join(''),
                decrypt: (text) => text.split('').reverse().join('')
            },
            xor: {
                encrypt: (text, key = 123) => {
                    return text.split('').map(char => 
                        String.fromCharCode(char.charCodeAt(0) ^ key)
                    ).join('');
                },
                decrypt: (text, key = 123) => {
                    return text.split('').map(char => 
                        String.fromCharCode(char.charCodeAt(0) ^ key)
                    ).join('');
                }
            },
            rot13: {
                encrypt: (text) => {
                    return text.replace(/[a-zA-Z]/g, function(char) {
                        return String.fromCharCode(
                            char <= 'Z' ? ((char.charCodeAt(0) - 65 + 13) % 26) + 65 :
                            ((char.charCodeAt(0) - 97 + 13) % 26) + 97
                        );
                    });
                },
                decrypt: (text) => encryptionMethods.rot13.encrypt(text)
            }
        };

        // Inicializaci√≥n
        function init() {
            generateCubeFaces();
            setupEventListeners();
            updateView();
            updateStats();
            showStatus("üöÄ Cubo de Memoria 3D iniciado. Explora las caras y almacena tus datos de forma segura.", "success");
        }

        function generateCubeFaces() {
            const faces = document.querySelectorAll('.cube-face');
            
            faces.forEach((face, faceIndex) => {
                // Crear 16 secciones por cara (4x4)
                for (let section = 0; section < 16; section++) {
                    const sectionDiv = document.createElement('div');
                    sectionDiv.className = 'section';
                    sectionDiv.dataset.face = face.dataset.face;
                    sectionDiv.dataset.section = section;
                    
                    // Crear 4 celdas por secci√≥n (2x2)
                    for (let cell = 0; cell < 4; cell++) {
                        const cellDiv = document.createElement('div');
                        cellDiv.className = 'cell';
                        cellDiv.dataset.face = face.dataset.face;
                        cellDiv.dataset.section = section;
                        cellDiv.dataset.cell = cell;
                        cellDiv.textContent = cell;
                        
                        cellDiv.addEventListener('click', (e) => {
                            e.stopPropagation();
                            selectCell(face.dataset.face, section, cell);
                        });
                        
                        sectionDiv.appendChild(cellDiv);
                    }
                    
                    sectionDiv.addEventListener('click', (e) => {
                        e.stopPropagation();
                        selectSection(face.dataset.face, section);
                    });
                    
                    face.appendChild(sectionDiv);
                }
            });
        }

        function setupEventListeners() {
            const container = document.getElementById('cubeContainer');
            
            // Eventos del mouse para rotaci√≥n
            container.addEventListener('mousedown', (e) => {
                isMouseDown = true;
                mouseX = e.clientX;
                mouseY = e.clientY;
                document.body.classList.add('dragging');
            });

            document.addEventListener('mousemove', (e) => {
                if (!isMouseDown) return;
                
                const deltaX = e.clientX - mouseX;
                const deltaY = e.clientY - mouseY;
                
                rotationY += deltaX * 0.5;
                rotationX -= deltaY * 0.5;
                
                rotationX = Math.max(-90, Math.min(90, rotationX));
                
                mouseX = e.clientX;
                mouseY = e.clientY;
                
                updateView();
            });

            document.addEventListener('mouseup', () => {
                isMouseDown = false;
                document.body.classList.remove('dragging');
            });

            // Zoom con rueda del mouse
            container.addEventListener('wheel', (e) => {
                e.preventDefault();
                const delta = e.deltaY > 0 ? 0.9 : 1.1;
                scale = Math.max(0.3, Math.min(3, scale * delta));
                updateView();
                document.getElementById('zoomLevel').textContent = Math.round(scale * 100);
            });
        }

        function updateView() {
            cube.style.transform = `rotateX(${rotationX}deg) rotateY(${rotationY}deg) scale(${scale})`;
        }

        function selectSection(face, section) {
            // Limpiar selecciones anteriores
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            
            // Seleccionar nueva secci√≥n
            const sectionElement = document.querySelector(`[data-face="${face}"][data-section="${section}"].section`);
            if (sectionElement) {
                sectionElement.classList.add('active');
                currentSelection = {face, section, cell: null};
                updateCurrentInfo();
            }
        }

        function selectCell(face, section, cell) {
            // Limpiar selecciones anteriores
            document.querySelectorAll('.cell').forEach(c => c.classList.remove('selected'));
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            
            // Seleccionar nueva celda
            const cellElement = document.querySelector(`[data-face="${face}"][data-section="${section}"][data-cell="${cell}"].cell`);
            const sectionElement = document.querySelector(`[data-face="${face}"][data-section="${section}"].section`);
            
            if (cellElement && sectionElement) {
                cellElement.classList.add('selected');
                sectionElement.classList.add('active');
                currentSelection = {face, section, cell};
                updateCurrentInfo();
                
                // Auto-rellenar campos del formulario
                document.getElementById('faceSelect').value = face;
                document.getElementById('sectionInput').value = section;
                document.getElementById('cellInput').value = cell;
            }
        }

        function updateCurrentInfo() {
            const faceNames = {
                front: 'Frontal', back: 'Trasera', right: 'Derecha',
                left: 'Izquierda', top: 'Superior', bottom: 'Inferior'
            };
            
            if (currentSelection) {
                document.getElementById('currentFace').textContent = faceNames[currentSelection.face];
                document.getElementById('currentSection').textContent = currentSelection.section;
                document.getElementById('currentCell').textContent = currentSelection.cell ?? '-';
            }
        }

        function storeData() {
            const face = document.getElementById('faceSelect').value;
            const section = parseInt(document.getElementById('sectionInput').value);
            const cell = parseInt(document.getElementById('cellInput').value);
            const label = document.getElementById('dataLabel').value.trim();
            const data = document.getElementById('dataToStore').value.trim();
            const method = document.getElementById('encryptionMethod').value;

            if (isNaN(section) || isNaN(cell) || !data) {
                showStatus("‚ùå Completa todos los campos requeridos.", "error");
                return;
            }

            if (section < 0 || section > 15 || cell < 0 || cell > 3) {
                showStatus("‚ùå Coordenadas fuera de rango.", "error");
                return;
            }

            const encryptedData = encryptionMethods[method].encrypt(data);
            const key = `${face}-${section}-${cell}`;
            
            dataStorage[key] = {
                label: label || 'Datos sin etiqueta',
                data: encryptedData,
                original: data,
                method: method,
                timestamp: new Date().toISOString(),
                face, section, cell
            };

            // Marcar celda visualmente
            const cellElement = document.querySelector(`[data-face="${face}"][data-section="${section}"][data-cell="${cell}"].cell`);
            if (cellElement) {
                cellElement.classList.add('has-data');
                cellElement.title = label || 'Datos almacenados';
            }

            showStatus(`‚úÖ Datos "${label}" almacenados en ${face.toUpperCase()}-${section}-${cell}`, "success");
            updateStats();
            
            // Limpiar formulario
            document.getElementById('dataLabel').value = '';
            document.getElementById('dataToStore').value = '';
        }

        function retrieveData() {
            if (!currentSelection || currentSelection.cell === null) {
                showStatus("‚ùå Selecciona una celda espec√≠fica primero.", "error");
                return;
            }

            const key = `${currentSelection.face}-${currentSelection.section}-${currentSelection.cell}`;
            const storedData = dataStorage[key];
            
            if (!storedData) {
                document.getElementById('dataDisplay').innerHTML = `
                    <div style="text-align: center; color: #666;">
                        üì≠ No hay datos en esta celda<br>
                        <small>Celda: ${currentSelection.face.toUpperCase()}-${currentSelection.section}-${currentSelection.cell}</small>
                    </div>
                `;
                showStatus("‚ÑπÔ∏è Celda vac√≠a.", "error");
                return;
            }
            
            currentEncryptedData = storedData;
            document.getElementById('dataDisplay').innerHTML = `
                <div style="border-bottom: 1px solid #00d4ff; padding-bottom: 10px; margin-bottom: 10px;">
                    <strong>üè∑Ô∏è ${storedData.label}</strong>
                </div>
                <div><strong>üìç Ubicaci√≥n:</strong> ${storedData.face.toUpperCase()}-${storedData.section}-${storedData.cell}</div>
                <div><strong>üîê M√©todo:</strong> ${storedData.method.toUpperCase()}</div>
                <div><strong>üìÖ Fecha:</strong> ${new Date(storedData.timestamp).toLocaleString()}</div>
                <div style="margin-top: 15px; padding: 10px; background: rgba(255,0,0,0.1); border: 1px solid #ff6666; border-radius: 4px;">
                    <strong>üîí Datos Encriptados:</strong><br>
                    <code style="word-break: break-all; font-size: 10px;">${storedData.data}</code>
                </div>
            `;
            
            showStatus("üìñ Datos cargados. Usa 'Desencriptar' para ver el contenido.", "success");
        }

        function decryptData() {
            if (!currentEncryptedData) {
                showStatus("‚ùå No hay datos para desencriptar.", "error");
                return;
            }
            
            const decrypted = encryptionMethods[currentEncryptedData.method].decrypt(currentEncryptedData.data);
            
            document.getElementById('dataDisplay').innerHTML = `
                <div style="border-bottom: 1px solid #00d4ff; padding-bottom: 10px; margin-bottom: 10px;">
                    <strong>üè∑Ô∏è ${currentEncryptedData.label}</strong>
                </div>
                <div><strong>üìç Ubicaci√≥n:</strong> ${currentEncryptedData.face.toUpperCase()}-${currentEncryptedData.section}-${currentEncryptedData.cell}</div>
                <div style="margin-top: 15px; padding: 15px; background: rgba(0,255,0,0.15); border: 2px solid #00ff64; border-radius: 6px;">
                    <div style="margin-bottom: 8px;"><strong>üîì DATOS DESENCRIPTADOS:</strong></div>
                    <div style="font-size: 14px; font-family: 'Courier New'; background: rgba(0,0,0,0.5); padding: 10px; border-radius: 4px; word-break: break-all;">
                        ${decrypted}
                    </div>
                </div>
                <div style="margin-top: 10px; font-size: 
